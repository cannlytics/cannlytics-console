<!doctype html>
<html>
<!-- Areas -->
<!-- Created 4/24/2021 -->
{% extends "cannlytics_console/console.html" %}
{% load icon %}
{% block console_body %}
  <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">

    <!-- Header-->
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
      <h1 class="fs-5 mb-0 lh-base">Areas</h1>
    </div>

    <!-- Body -->
    <div class="col">

      <!-- Table -->
      <div
        id="areas-table"
        class="ag-theme-alpine"
        style="height: 400px; width:100%%;"
      ></div>

    </div><!-- End of body -->

  </main>

{% endblock console_body %}

{% block console_js %}

  <!-- JavaScript -->
  <script type="text/javascript" charset="utf-8">

    // TODO: Specify the columns.
    const columnDefs = [
      { field: "make", sortable: true, filter: true, editable: true, checkboxSelection: true }, // , checkboxSelection: true
      { field: "model", sortable: true, filter: true, editable: true },
      { field: "price", sortable: true, filter: true, editable: true }
    ];

    // TODO: Get the data.
    {% comment %} const rowData = [
      { make: "Toyota", model: "Celica", price: 35000 },
      { make: "Ford", model: "Mondeo", price: 32000 },
    ]; {% endcomment %}

    // Specify the table options.
    const gridOptions = {
      columnDefs: columnDefs,
      pagination: true,
      rowSelection: 'multiple',
      suppressRowClickSelection: false,
      // singleClickEdit: true,
      onRowClicked: event => console.log('A row was clicked'),
      onGridReady: event => cannlytics.theme.toggleTheme(cannlytics.theme.getTheme()),
    };

    // Get the data and render the table.
    console.log(cannlytics.api);
    cannlytics.api.getAreas().then((data) => {
      console.log('Areas:', data);
      const eGridDiv = document.querySelector('#areas-table');
      new agGrid.Grid(eGridDiv, gridOptions);
      gridOptions.api.setRowData(rowData);
    })
    .catch((error) => {
      console.log('Error:', error);
    });

    // TODO: Attach export functionality
    //function exportTableData() {
    //  gridOptions.api.exportDataAsCsv();
    //}

  </script>

{% endblock console_js %}

</html>
